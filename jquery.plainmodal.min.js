!function(e){function o(o,t){var l=e.extend({duration:200,effect:{open:e.fn.fadeIn,close:e.fn.fadeOut},overlay:{color:"#000",opacity:.3},closeClass:"plainmodal-close"},t);return c=c||e("body"),f=f||e("<div />").css({position:"fixed",left:0,top:0,width:"100%",height:"100%",display:"none",zIndex:9e3}).appendTo(c).click(n),h=h||e(window),o.each(function(){var o=e(this),t={position:"fixed",display:"none",zIndex:9001};l.offset?(t.left=l.offset.left,t.top=l.offset.top,t.marginLeft=t.marginTop=""):(t.left=t.top="50%",t.marginLeft="-"+o.outerWidth()/2+"px",t.marginTop="-"+o.outerHeight()/2+"px"),l.closeClass&&o.find("."+l.closeClass).off("click",n).click(n),o.css(t).data("plainModal",l).appendTo(c)})}function t(t,n){var y,w,x,T;return null===g&&t.length&&(y=t.eq(0),(n||!(w=y.data("plainModal")))&&(w=o(y,n).data("plainModal")),u=c.css("overflow"),x=c.width(),T=c.height(),c.css("overflow","hidden"),x-=c.width(),T-=c.height(),d=p=0,0>x&&c.css("marginRight","+="+(d=-x)),0>T&&c.css("marginBottom","+="+(p=-T)),m=h.scrollLeft(),v=h.scrollTop(),r=e(document.activeElement),w.effect.open.call(y,w.duration,function(){s=null,y.find("a,input,select,textarea,button,object,area,img,map").each(function(){var o=e(this);return o.focus().get(0)===document.activeElement?(s=o,!1):void 0}),e(document.activeElement).blur(),e(document).focusin(l).keydown(a),h.scroll(i),g=y}),f.css("backgroundColor",w.overlay.color).fadeTo(w.duration,w.overlay.opacity),g=0),t}function n(o){var t;return g&&(t=g.data("plainModal"),t.effect.close.call(g,t.duration,function(){e(document).off("focusin",l).off("keydown",a),h.off("scroll",i),c.css("overflow",u),d&&c.css("marginRight","-="+d),p&&c.css("marginBottom","-="+p),r&&r.length&&r.focus(),h.scrollLeft(m),h.scrollTop(v),g=null}),f.fadeOut(t.duration),g=0),o instanceof jQuery.Event?(o.preventDefault(),!1):o}function l(o){g&&!g.has(o.target).length&&(s?s.focus():e(document.activeElement).blur())}function a(e){return 27===e.keyCode?(n(),e.preventDefault(),!1):void 0}function i(e){return h.scrollLeft(m),h.scrollTop(v),e.preventDefault(),!1}var c,f,r,s,u,d,p,h,m,v,g=null;e.fn.plainModal=function(e,l){return"open"===e?t(this,l):"close"===e?n(this):o(this,e)}}(jQuery);